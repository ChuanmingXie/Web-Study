<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>咖啡商城-购物车</title>
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/shopcart.css">
</head>

<body>
    <article>
        <!-- header start -->
        <header>
            <div class="header_bg" id="header_bg">
                <div class="logo_bg" title="咖啡商城-白咖啡,咖啡豆,咖啡机,Coffee18.com">
                    <a href="#" hidefocus="true">
                        <img src="./img/coffee/logo.gif" alt="咖啡商城-白咖啡,咖啡豆,咖啡机,Coffee18.com">
                    </a>
                </div>
                <div class="search_bg">
                    <div class="search_content">
                        <div class="formclass">
                            <form action="" method="GET">
                                <input type="text" class="search_text" name="keyword" autocomplete="off">
                                <input type="submit" class="search_btn" value="搜索" hidefocus="true">
                                <input type="hidden" name="act" id="" value="index">
                                <input type="hidden" name="app" id="" value="search">
                            </form>
                        </div>
                    </div>
                    <div class="hotwords">
                        <strong>热门搜索：</strong>
                        <a href="">白咖啡</a>
                        <a href="">咖啡豆</a>
                        <a href="">咖啡机</a>
                        <a href="">咖啡杯</a>
                        <a href="">咖啡厅</a>
                    </div>
                </div>
                <div class="orderlink_bg">
                    <dl>
                        <dt class="dtclass"><s></s><a href="orders.html">我的订单</a></dt>
                    </dl>
                </div>
                <div class="shopcart_link">
                    <dl>
                        <dt class="dtclass">
                            <a href="">购物车<strong id="good_amount"> 4 </strong>种商品</a>
                            <b></b>
                        </dt>
                    </dl>
                </div>
            </div>
        </header>
        <!-- header end -->

        <!-- middle section start -->
        <section class="middle">
            <div class="tools_header">
                <div class="select_all">
                    <input type="checkbox" name="selectAll" onchange="checkAll(event);"> 全选
                </div>
                <div class="good_info">商品信息简介</div>
                <div class="good_title">单价(元)</div>
                <div class="good_title">数量</div>
                <div class="good_title">金额(元)</div>
                <div class="good_operate">操作</div>
                <div class="clear"></div>
            </div>
            <form action="">
                <div class="checkitem">
                    <input type="checkbox" name="checkshop" id="checkshop1" onchange="checkBrand(event);"> 品牌：麦克威尔
                </div>
                <div class="gooditem">
                    <div class="select_all">
                        <input type="checkbox" name="goods" id="1" onchange="checkthis(event);">
                        <img src="./img/coffee/shoppcart/1.jpg" width="79" height="80" alt=""
                            onmouseover="showBigPic(bigPic1);" onmouseout="hideBigPic(bigPic1);">
                        <div class="itemPic" id="bigPic1">
                            <img src="./img/coffee/shoppcart/11.jpg" width="238" height="240" alt="大图">
                        </div>
                        <div class="good_intro">
                            <a href="" alt="麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条">
                                麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条
                            </a>
                        </div>
                    </div>
                    <div class="good_info info_content">特浓咖啡 3和装 共90条</div>
                    <div class="good_title" id="price1">89.2</div>
                    <div class="good_title">
                        <input type="number" name="shopCount" id="amount1" value="1" onchange="goodCount(1)">
                    </div>
                    <div class="good_title" id="sumprice1">89.2</div>
                    <div class="good_operate operate_bg">
                        <a href="">移入收藏夹</a>
                        <a href="">删除</a>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="gooditem">
                    <div class="select_all">
                        <input type="checkbox" name="goods" id="2" onchange="checkthis(event);">
                        <img src="./img/coffee/shoppcart/2.jpg" width="79" height="80" alt=""
                            onmouseover="showBigPic(bigPic2);" onmouseout="hideBigPic(bigPic2);">
                        <div class="itemPic" id="bigPic2">
                            <img src="./img/coffee/shoppcart/22.jpg" width="238" height="240" alt="大图">
                        </div>
                        <div class="good_intro">
                            <a href="" alt="麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条">
                                麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条
                            </a>
                        </div>
                    </div>
                    <div class="good_info">特浓咖啡 3和装 共90条</div>
                    <div class="good_title" id="price2">89.2</div>
                    <div class="good_title">
                        <input type="number" name="shopCount" id="amount2" value="1" onchange="goodCount(2)">
                    </div>
                    <div class="good_title" id="sumprice2">89.2</div>
                    <div class="good_operate operate_bg">
                        <a href="">移入收藏夹</a>
                        <a href="">删除</a>
                    </div>
                    <div class="clear"></div>
                </div>
            </form>
            <form action="">
                <div class="checkitem">
                    <input type="checkbox" name="checkshop" id="checkshop2" onchange="checkBrand(event);"> 品牌：雀巢咖啡
                </div>
                <div class="gooditem">
                    <div class="select_all">
                        <input type="checkbox" name="goods" id="3" onchange="checkthis(event);">
                        <img src="./img/coffee/shoppcart/3.jpg" width="79" height="80" alt=""
                            onmouseover="showBigPic(bigPic3);" onmouseout="hideBigPic(bigPic3);">
                        <div class="itemPic" id="bigPic3">
                            <img src="./img/coffee/shoppcart/33.jpg" width="238" height="240" alt="大图">
                        </div>
                        <div class="good_intro">
                            <a href="" alt="麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条">
                                麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条
                            </a>
                        </div>
                    </div>
                    <div class="good_info">特浓咖啡 3和装 共90条</div>
                    <div class="good_title" id="price3">89.2</div>
                    <div class="good_title">
                        <input type="number" name="shopCount" id="amount3" value="1" onchange="goodCount(3)">
                    </div>
                    <div class="good_title" id="sumprice3">89.2</div>
                    <div class="good_operate operate_bg">
                        <a href="">移入收藏夹</a>
                        <a href="">删除</a>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="gooditem">
                    <div class="select_all">
                        <input type="checkbox" name="goods" id="4" onchange="checkthis(event);">
                        <img src="./img/coffee/shoppcart/4.jpg" width="79" height="80" alt=""
                            onmouseover="showBigPic(bigPic4);" onmouseout="hideBigPic(bigPic4);">
                        <div class="itemPic" id="bigPic4">
                            <img src="./img/coffee/shoppcart/44.jpg" width="238" height="240" alt="大图">
                        </div>
                        <div class="good_intro">
                            <a href="" alt="麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条">
                                麦斯威尔Maxwell House三合一速溶咖啡粉 特浓咖啡 3盒装 共90条
                            </a>
                        </div>
                    </div>
                    <div class="good_info">特浓咖啡 3和装 共90条</div>
                    <div class="good_title" id="price4">89.2</div>
                    <div class="good_title">
                        <input type="number" name="shopCount" id="amount4" value="1" onchange="goodCount(4)">
                    </div>
                    <div class="good_title" id="sumprice4">89.2</div>
                    <div class="good_operate operate_bg">
                        <a href="">移入收藏夹</a>
                        <a href="">删除</a>
                    </div>
                    <div class="clear"></div>
                </div>
            </form>
            <div class="checkOut_bg">
                已选商品<span id="selectnum">0</span>件
                合计(不含运费) <span class="price">￥<span id="money">0</span></span>
                <a href="">
                    <div class="checkOutBtn">结算</div>
                </a>
            </div>
        </section>
        <!-- middle section end -->

        <!-- footer start -->
        <footer class="footer">
            营销中心廉正举报联系客服开放平台诚征英 2022 &copy; CofeeShop.com 版权所有 关于咖啡商城商务合作请联系 021-133453254 <br>
            电商网络经营许可证：coffee web[2018]004 号|增值电信业务经营许可证：沪A2-20180004-1|信息网络传播视听节目许可证：1801004号
        </footer>
        <!-- footer end -->
    </article>

    <script>
        /* 全选商品 */
        function checkAll(event) {
            if (event.srcElement.checked) {
                //如果是顶部操作栏是选中动作，则进行全选操作
                var inputList = document.getElementsByTagName('input');
                for (let i = 0; i < inputList.length; i++) {
                    if (inputList[i].type == "checkbox") {
                        inputList[i].checked = true;
                    }
                }
            } else {
                //如果是顶部操作栏是取消选中动作，则进行全不选操作
                var inputList = document.getElementsByTagName('input');
                for (let i = 0; i < inputList.length; i++) {
                    if (inputList[i].type == "checkbox") {
                        inputList[i].checked = false;
                    }
                }
            }
            //最后将页面的数据收集后计算
            calSumMoney();
        }
        /* 全选店铺 */
        function checkBrand(event) {
            if (event.srcElement.checked) {
                var checboxlist = event.srcElement.form.goods;
                //如果当前店铺的操作栏多选框被选中，则将该店铺的商品全选
                for (let i = 0; i < checboxlist.length; i++) {
                    checboxlist[i].checked = true;
                }
            } else {
                //如果当前店铺的多选框被取消选中，则将该店铺的商品全不选
                var checboxlist = event.srcElement.form.goods;
                for (let i = 0; i < checboxlist.length; i++) {
                    checboxlist[i].checked = false;
                }
            }
            // 检查以下全选复选框的状态是否可以变成全选
            selectAllState();
            //最后将页面的数据收集后计算
            calSumMoney();
        }
        /* 选中当前 */
        function checkthis(event) {
            /* 选中当前本来可以不进行额外操作，但是因为商铺全选的存在，
            在选中当前后要根据店铺选中的情况改变，当前商铺的全选的状态 */
            if (event.srcElement.checked) {
                var j = 0;
                var checkboxList = event.srcElement.form.goods;
                for (let i = 0; i < checkboxList.length; i++) {
                    if (checkboxList[i].checked) {
                        j++;
                    } else {
                        break;
                    }
                }
                if (j == checkboxList.length) {
                    event.srcElement.form.checkshop.checked = true;
                }
            } else {
                event.srcElement.form.checkshop.checked = false;
            }
            // 检查以下全选复选框的状态是否可以变成全选
            selectAllState();
            //最后将页面的数据收集后计算
            calSumMoney();
        }

        function selectAllState() {
            var inputList = document.getElementsByTagName('input');
            var checkboxList = new Array();
            var checkednum = 1;
            // for
            Array.from(inputList).forEach(element => {
                if (element.type == "checkbox") {
                    checkboxList.push(element)
                    if (element.checked) {
                        checkednum++;
                    }
                }
            });
            document.getElementsByName('selectAll')[0].checked =
                (checkboxList.length == checkednum) ? true : false;
        }

        /* 金额小计 */
        function goodCount(x) {
            var price = document.getElementById('price' + x).innerHTML;
            var amount = document.getElementById('amount' + x).value;
            document.getElementById('sumprice' + x).innerHTML = (price) * (amount);
            calSumMoney();
        }

        /* 金额总计 */
        function calSumMoney() {
            var selectnum = 0;
            var money = 0;
            var selectList = document.getElementsByTagName('input');
            for (let i = 0; i < selectList.length; i++) {
                if (selectList[i].type == 'checkbox') {
                    if (selectList[i].checked && selectList[i].name == 'goods') {
                        t = document.getElementById('sumprice' + selectList[i].id).innerHTML;
                        selectnum += 1;
                        money += Number(t);
                    }
                }
            }
            document.getElementById('selectnum').innerHTML = selectnum;
            document.getElementById('money').innerHTML = money.toFixed(2);
        }

        /* 大图显示与隐藏 */
        function showBigPic(pic) {
            var picdisplay = pic.style.display = 'block';
        }
        function hideBigPic(pic) {
            var picdisplay = pic.style.display = "none";
        }
    </script>
</body>

</html>